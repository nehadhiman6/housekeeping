import $ from"./FormWrapper-5c0db3ce.js";import v from"./ButtonComp-7a3fe749.js";import d from"./InputLabel-69092e66.js";import U from"./TextInput-414aae93.js";import D from"./TextAreaInput-5805d6a7.js";import x from"./SelectInput-e436eb1f.js";import M from"./MachineSelect-7875d756.js";import C from"./DepartmentSelect-20b0fcb3.js";import B from"./AreaSelect-d5b0446d.js";import F from"./DatePicker-3e693273.js";import{_ as n}from"./InputError-fee228bf.js";import{g as N}from"./globalMixin-827f0fbc.js";import{i as V,q as T,j as q,o as m,e as c,b as s,w as p,a as r,f as u,g as y}from"./app-92be7c25.js";const A={class:"flex flex-wrap items-end -mx-3"},G={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},P={class:"mb-2"},R={class:"w-full max-w-full px-3 lg:w-2/4 md:w-1/4"},j={key:0,class:"mb-2"},E={key:0,class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},O={class:"mb-2"},W={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},Y={key:0,class:"mb-2"},z={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},H={key:0,class:"mb-2"},J={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},K={class:"mb-2"},L={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},Q={class:"mb-2"},X={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},Z={class:"mb-2"},ee={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},ae={class:"mb-2"},fe={__name:"CaseForm",props:["form_id","machine_id"],emits:["resetForm"],setup(k,{emit:f}){const o=k,{base_url:w,copyProperties:h,refreshComponent:_}=N(),e=V(new Form({form_id:0,machine_id:"",case_no:"",open_date:CMS.today,closed_date:"",work_types:"",work_order_types:"",status:"",description:"",generated_user_id:""})),i=V({create_url:"machine-cases",show:!0,departmentInitials:[],showDeptarea:!0,departmentSelected:[],areaInitials:[],areaSelected:[],machineInitials:[],machineSelected:[],showMachine:!0}),S=T(()=>o.form_id>0?"Update ":"Schedule Service");q(()=>{o.machine_id>0&&g(o.machine_id),o.form_id>0&&I()});const b=()=>{e.postForm(i.create_url).then(function(l){console.log(l),l.success&&(f("resetForm"),Utilities.showPopMessage("Your data has been saved successfully!"))}).catch(function(l){})},g=l=>{axios.get(w.value+"/machine-details/"+l).then(function(a){if(a.data.success){let t=a.data.machine;h(t,e),o.machine_id>0&&(e.machine_id=o.machine_id,i.machineInitials=[{id:t.id,text:t.serial_no}],i.machineSelected=[t.id],_(i,"show")),t.department&&(i.departmentInitials=[{id:t.department.id,text:t.department.name}],i.departmentSelected=[t.department.id]),t.area&&(i.areaInitials=[{id:t.area.id,text:t.area.name}],i.areaSelected=[t.area.id]),_(i,"showDeptarea")}e.form_id=o.form_id}).catch(function(a){})},I=()=>{axios.get(w.value+"/machine-cases/"+o.form_id+"/edit").then(function(l){if(l.data.success){let a=l.data.service;h(a,e),e.form_id=a.id,a.machine&&(i.machineInitials=[{id:a.machine.id,text:a.machine.serial_no}],i.machineSelected=[a.machine.id]),a.machine.department&&(i.departmentInitials=[{id:a.machine.department.id,text:a.machine.department.name}],i.departmentSelected=[a.machine.department.id]),a.machine.area&&(i.areaInitials=[{id:a.machine.area.id,text:a.machine.area.name}],i.areaSelected=[a.machine.area.id]),_(i,"show"),_(i,"showDeptarea")}e.form_id=o.form_id}).catch(function(l){})};return(l,a)=>(m(),c("div",null,[s($,{title:S.value},{default:p(()=>[r("div",A,[r("div",G,[r("div",P,[s(d,{for:"open_date",value:"Date"}),s(F,{modelValue:e.open_date,"onUpdate:modelValue":a[0]||(a[0]=t=>e.open_date=t),"class-name":"open_date",error:!!e.errors.get("open_date")},null,8,["modelValue","error"]),s(n,{class:"mt-2",message:e.errors.get("open_date")},null,8,["message"])])]),r("div",R,[i.show?(m(),c("div",j,[s(d,{for:"machine_id",value:"Machine"}),s(M,{disabled:o.machine_id>0,modelValue:e.machine_id,"onUpdate:modelValue":a[1]||(a[1]=t=>e.machine_id=t),initials:i.machineInitials,selected:i.machineSelected,onUpdateMachine:g},null,8,["disabled","modelValue","initials","selected"]),s(n,{class:"mt-2",message:e.errors.get("machine_id")},null,8,["message"])])):u("",!0)]),e.form_id>0?(m(),c("div",E,[r("div",O,[s(d,{for:"case_no",value:"Service No.(Auto generated)"}),s(U,{modelValue:e.case_no,"onUpdate:modelValue":a[2]||(a[2]=t=>e.case_no=t),disabled:"",type:"text",required:"",autofocus:"",error:!!e.errors.get("case_no")},null,8,["modelValue","error"]),s(n,{class:"mt-2",message:e.errors.get("case_no")},null,8,["message"])])])):u("",!0),r("div",W,[i.showDeptarea?(m(),c("div",Y,[s(d,{for:"department_id",value:"Department"}),s(C,{disabled:!0,modelValue:e.department_id,"onUpdate:modelValue":a[3]||(a[3]=t=>e.department_id=t),initials:i.departmentInitials,selected:i.departmentSelected},null,8,["modelValue","initials","selected"]),s(n,{class:"mt-2",message:e.errors.get("department_id")},null,8,["message"])])):u("",!0)]),r("div",z,[i.showDeptarea?(m(),c("div",H,[s(d,{for:"area_id",value:"Area"}),s(B,{disabled:!0,modelValue:e.area_id,"onUpdate:modelValue":a[4]||(a[4]=t=>e.area_id=t),department_id:e.department_id,initials:i.areaInitials,selected:i.areaSelected},null,8,["modelValue","department_id","initials","selected"]),s(n,{class:"mt-2",message:e.errors.get("area_id")},null,8,["message"])])):u("",!0)]),r("div",J,[r("div",K,[s(d,{for:"work_types",value:"Service Type"}),s(x,{modelValue:e.work_types,"onUpdate:modelValue":a[5]||(a[5]=t=>e.work_types=t),options:[{id:"Installation",text:"Installation"},{id:"Maintenance",text:"Maintenance"},{id:"BreakDown",text:"BreakDown"}],error:!!e.errors.get("work_types")},null,8,["modelValue","error"]),s(n,{class:"mt-2",message:e.errors.get("work_types")},null,8,["message"])])]),r("div",L,[r("div",Q,[s(d,{for:"work_order_types",value:"Work Order Type"}),s(x,{modelValue:e.work_order_types,"onUpdate:modelValue":a[6]||(a[6]=t=>e.work_order_types=t),options:[{id:"Installation",text:"Installation"},{id:"Repair",text:"Repair"},{id:"General Service",text:"General Service"}],error:!!e.errors.get("work_order_types")},null,8,["modelValue","error"]),s(n,{class:"mt-2",message:e.errors.get("work_order_types")},null,8,["message"])])]),r("div",X,[r("div",Z,[s(d,{for:"description",value:"Description"}),s(D,{modelValue:e.description,"onUpdate:modelValue":a[7]||(a[7]=t=>e.description=t)},null,8,["modelValue"]),s(n,{class:"mt-2",message:e.errors.get("description")},null,8,["message"])])]),r("div",ee,[r("div",ae,[s(v,{onButtonClicked:b,type:"save"},{default:p(()=>[y(" Save ")]),_:1}),s(v,{onButtonClicked:a[8]||(a[8]=t=>f("resetForm")),type:"cancel"},{default:p(()=>[y(" Cancel ")]),_:1})])])])]),_:1},8,["title"])]))}};export{fe as default};
