import{K as y,i as _,j as k,a6 as b,o as s,c as l,w as d,s as w,B as S,a as m,f as g,b as C,g as M}from"./app-92be7c25.js";import"./index-4bb81809.js";import{_ as O}from"./AppLayout-44e5a529.js";import T from"./ListWrapper-0c2f9604.js";import B from"./ButtonComp-7a3fe749.js";import N from"./CaseForm-b9a29904.js";import R from"./MachineCaseFilter-0d4013be.js";import{g as F}from"./globalMixin-827f0fbc.js";import"./SideNavLink-7f5d99b7.js";import"./SideNavDropDown-3a860ee4.js";import"./SideDropDownItemLink-cd206ce4.js";import"./ProjectLogo-ab93dec1.js";import"./BreadCrumbs-ba3968f1.js";import"./FormWrapper-5c0db3ce.js";import"./InputLabel-69092e66.js";import"./TextInput-414aae93.js";import"./TextAreaInput-5805d6a7.js";import"./SelectInput-e436eb1f.js";import"./MachineSelect-7875d756.js";import"./DepartmentSelect-20b0fcb3.js";import"./AreaSelect-d5b0446d.js";import"./DatePicker-3e693273.js";import"./InputError-fee228bf.js";import"./FilterWrapper-3eb81350.js";import"./MachineModelSelect-8f2a2e9e.js";const j=m("i",{class:"fa-solid fa-plus mr-2"},null,-1),D=m("table",{id:"service_list",width:"100%",class:"row-border stripe"},null,-1),le={__name:"CaseList",props:[],setup(H){const p=y(),{base_url:c,canAny:u}=F(),a=_({formOpen:!1,table:null,form_id:0,random:Utilities.getRandomNumber()}),i=_(new Form({machine_id:0,machine_model_id:"",status:"P",from_date:CMS.from_date,to_date:CMS.today})),f=()=>{a.form_id=0,a.table.ajax.reload(null,!1),a.formOpen=!1},h=e=>{a.formOpen=!0,a.form_id=e};k(()=>{v()});const v=()=>{a.table=$("#service_list").DataTable({dom:"Bfrtip",lengthMenu:[[10,25,50,-1],["10 rows","25 rows","50 rows","Show all"]],buttons:["pageLength",{extend:"excelHtml5",header:!0,footer:!0,exportOptions:{orthogonal:"export",columns:":not(:last-child)"},filename:function(){return"Housekeeping Machines Service Cases"},title:function(){var e="Housekeeping Machines Service Cases";return e}},{extend:"pdfHtml5",orientation:"landscape",exportOptions:{orthogonal:"export",columns:":not(:last-child)"},customize:function(e){e.content[1].table.body.forEach(t=>{t.forEach(r=>{r.alignment="center"})}),e.content[1].table.widths=Array(e.content[1].table.body[0].length+1).join("*").split("")}}],processing:!0,serverSide:!0,searchDelay:700,ordering:!0,scrollY:"350px",scrollCollapse:!1,pageLength:10,ajax:{url:c.value+"/machine-cases-list",type:"GET",data:function(e){e.machine_id=i.machine_id,e.model_id=i.machine_model_id,e.status=i.status,e.from_date=i.from_date,e.to_date=i.to_date}},createdRow:function(e,t,r){$(e).addClass("bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600")},columns:[{title:"Sr no.",data:"id",render:function(e,t,r,n){var o=n.row+parseInt(n.settings.json.start)+1;return o}},{title:"Department",data:"department_name"},{title:"Area",data:"area"},{title:"Case No.",data:"case_no",render:function(e,t,r,n){return"<a   data-item-id="+r.id+" class='font-bold cursor-pointer text-sky-600 text-base services' >"+e+"</a>"}},{title:"Work Type",data:"work_types"},{title:"Scheduled Date",data:"open_date"},{title:"Machine Serial No.",data:"serial_no"},{title:"Brand",data:"brand_name"},{title:"Model",data:"model_no"},{title:"Machine Type",data:"machine_type"},{title:"Remarks",data:"description"},{title:"Status",data:"status",render:function(e,t,r,n){return e=="P"?"Pending":e=="C"?"Closed":e=="F"?"Follow-Up Required":""}},{title:"Actions",orderable:!1,data:"id",render:function(e,t,r,n){var o='<div class="flex items-end">';if(u(p.props.granted_permissions,["schedule-services-modify"])&&(o+="<button  data-item-id="+e+' class="flex inline-block dark:text-white px-4 py-2.5 mb-0 font-bold text-center align-middle transition-all bg-transparent border-0 rounded-lg shadow-none cursor-pointer leading-normal text-sm ease-in bg-150 hover:-translate-y-px active:opacity-85 bg-x-25 text-slate-700  edit-item"><i class="mr-2 fas fa-pencil-alt text-slate-700  edit-item" aria-hidden="true"  data-item-id='+e+"></i> Edit </button>"),u(p.props.granted_permissions,["services"])&&(r.status=="P"||r.status=="F")){let x=r.status=="P"?"Service":"Follow-Up";o+="<button  data-item-id="+e+' class="inline-block dark:text-white px-4 py-2.5 mb-0 font-bold text-center align-middle transition-all bg-transparent border-0 rounded-lg shadow-none cursor-pointer leading-normal text-sm ease-in bg-150 hover:-translate-y-px active:opacity-85 bg-x-25 text-slate-700  case-service">'+x+" </button>"}return o+="</div>",o}}],drawCallback:function(e){$(".edit-item").on("click",function(t){a.formOpen=!1,setTimeout(function(){h(t.target.dataset.itemId)},200)}),$(".case-service").on("click",function(t){b.visit(c.value+"/services/"+t.target.dataset.itemId)}),$(".services").on("click",function(t){b.visit(c.value+"/services-details/"+t.target.dataset.itemId)})}})};return(e,t)=>(s(),l(O,{title:"Housekeeping Machines's Scheduled Service "},{default:d(()=>[w((s(),l(R,{key:a.random,form:i,onReloadTable:f},null,8,["form"])),[[S,a.formOpen==!1]]),m("div",null,[a.formOpen?(s(),l(N,{key:0,onReloadTable:f,form_id:a.form_id},null,8,["form_id"])):g("",!0),C(T,{title:"Machine Service Requests"},{button:d(()=>[a.formOpen==!1?(s(),l(B,{key:0,onButtonClicked:t[0]||(t[0]=r=>a.formOpen=!0),type:"new"},{default:d(()=>[j,M(" Schedule Service ")]),_:1})):g("",!0)]),table:d(()=>[D]),_:1})])]),_:1}))}};export{le as default};
