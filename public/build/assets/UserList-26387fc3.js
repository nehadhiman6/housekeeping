import"./index-4bb81809.js";import{_ as k}from"./AppLayout-44e5a529.js";import w from"./ListWrapper-0c2f9604.js";import A from"./ButtonComp-7a3fe749.js";import N from"./UserForm-c1817380.js";import{g as D}from"./globalMixin-827f0fbc.js";import O from"./UserNav-1c365146.js";import{K as C,i as U,j,o as d,c,w as o,b as g,a as l,f as x,g as B}from"./app-92be7c25.js";import"./SideNavLink-7f5d99b7.js";import"./SideNavDropDown-3a860ee4.js";import"./SideDropDownItemLink-cd206ce4.js";import"./ProjectLogo-ab93dec1.js";import"./BreadCrumbs-ba3968f1.js";import"./FormWrapper-5c0db3ce.js";import"./InputLabel-69092e66.js";import"./TextInput-414aae93.js";import"./SelectInput-e436eb1f.js";import"./InputError-fee228bf.js";import"./UpperNavLink-2b7e1e80.js";const E=l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," State ",-1),I=l("i",{class:"fa-solid fa-plus mr-2"},null,-1),S=l("table",{id:"users_list",width:"100%",class:"row-border stripe"},null,-1),at={__name:"UserList",props:["roles"],setup(_){const{base_url:m,canAny:p}=D(),u=C(),i=U({formOpen:!1,table:null,form_id:0}),f=()=>{i.form_id=0,i.formOpen=!1,i.table.ajax.reload(null,!1)},h=n=>{i.formOpen=!0,i.form_id=n};j(()=>{v()});const v=()=>{i.table=$("#users_list").DataTable({processing:!0,serverSide:!0,searchDelay:700,ordering:!0,scrollY:"350px",scrollCollapse:!1,pageLength:10,ajax:{url:m.value+"/users-list",type:"GET"},createdRow:function(t,a,r){$(t).addClass("bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600")},columns:[{title:"Sr no.",data:"id",render:function(t,a,r,s){var e=s.row+parseInt(s.settings.json.start);return e+1}},{title:"Name",data:"name"},{title:"Email",data:"email"},{title:"Role",data:"id",render:function(t,a,r,s){return r.roles&&r.roles.length>0&&r.roles[0]?r.roles[0].name:""}},{title:"Departments",data:"id",render:function(t,a,r,s){var e=[];r.departments.forEach(b=>{b.branch&&e.push(b.name)});var y=Utilities.joinArrayAsString(e);return y}},{title:"Actions",orderable:!1,data:"id",render:function(t,a,r,s){let e="";return e+="<button  data-item-id="+t+' class="inline-block dark:text-white px-4 py-2.5 mb-0 font-bold text-center align-middle transition-all bg-transparent border-0 rounded-lg shadow-none cursor-pointer leading-normal text-sm ease-in bg-150 hover:-translate-y-px active:opacity-85 bg-x-25 text-slate-700 edit-item"><i class="mr-2 fas fa-pencil-alt edit-item text-slate-700"  data-item-id='+t+'  aria-hidden="true"></i> Edit </button>',p(u.props.granted_permissions,["user-sites"])&&(e+="<a href='users/"+t+"/departments ' class='inline-block dark:text-white px-4 py-2.5 mb-0 font-bold text-center align-middle transition-all bg-transparent border-0 rounded-lg shadow-none cursor-pointer leading-normal text-sm ease-in bg-150 hover:-translate-y-px active:opacity-85 bg-x-25 text-slate-700 edit-item' target = _blank><i class='mr-2 fas fa-pencil-alt  text-slate-700'  aria-hidden='true'></i> Departments</a>"),p(u.props.granted_permissions,["user-active-deactive"])&&(r.active=="N"?e+="<button  data-item-id="+t+' data-status="Y"  data-type="Active" class="inline-block text-white px-4 py-2.5 mb-0 font-bold text-center align-middle transition-all bg-orange-500 border-0 rounded-lg shadow-none cursor-pointer leading-normal text-sm ease-in bg-150 hover:-translate-y-px active:opacity-85 bg-x-25 text-slate-700 active">Active</button>':e+="<button  data-item-id="+t+' data-status="N" data-type="De-Active" class="inline-block text-white px-4 py-2.5 mb-0 font-bold text-center align-middle transition-all bg-red-500 border-0 rounded-lg shadow-none cursor-pointer leading-normal text-sm ease-in bg-150 hover:-translate-y-px active:opacity-85 bg-x-25 text-slate-700 active">Deactive</button>'),e}}],drawCallback:function(t){$(".edit-item").on("click",function(a){i.formOpen=!1,h(a.target.dataset.itemId)}),$(".active").on("click",function(a){n(a.target.dataset.itemId,a.target.dataset.status,a.target.dataset.type)})}});const n=(t,a,r)=>{confirm("Are you sure you want to "+r+" user ?")&&axios.get(m.value+"/users/active-deactive/",{params:{user_id:t,status:a}}).then(function(e){e.data.success&&(e.data.user,f())}).catch(function(e){})}};return(n,t)=>(d(),c(k,{title:"Users"},{header:o(()=>[E]),default:o(()=>[g(O),l("div",null,[i.formOpen?(d(),c(N,{key:0,onResetForm:f,form_id:i.form_id,roles:_.roles},null,8,["form_id","roles"])):x("",!0),g(w,{title:"Users List"},{button:o(()=>[i.formOpen==!1?(d(),c(A,{key:0,onButtonClicked:t[0]||(t[0]=a=>i.formOpen=!0),type:"new"},{default:o(()=>[I,B(" New User ")]),_:1})):x("",!0)]),table:o(()=>[S]),_:1})])]),_:1}))}};export{at as default};
