import{K as q,i as U,q as A,j as T,o as n,e as d,b as l,w as u,a as t,t as h,f as _,F as b,h as y,g as f,c as C}from"./app-92be7c25.js";import E from"./FormWrapper-5c0db3ce.js";import $ from"./ButtonComp-7a3fe749.js";import p from"./InputLabel-69092e66.js";import K from"./TextInput-414aae93.js";import k from"./TextAreaInput-5805d6a7.js";import L from"./DatePicker-3e693273.js";import z from"./ProblemsSelect-72709c7e.js";import G from"./ResolvingActionSelect-a72f660b.js";import H from"./MaintenanceSelect-75de202f.js";import J from"./CaseCard-ae1d1e8e.js";import M from"./RadioInput-b4d696db.js";import V from"./CheckboxInput-75e356eb.js";import{_ as v}from"./InputError-fee228bf.js";import{g as O}from"./globalMixin-827f0fbc.js";import"./index-4bb81809.js";const Q={class:"grid grid-rows-3 grid-flow-col grid-cols-4 gap-4"},W={class:"row-span-3 grid-cols-1"},X={class:"col-span-3"},Z={class:"border rounded bg-gray-50 p-4 mb-1 mt-4"},ee=["textContent"],se={class:"flex flex-wrap items-end -mx-3"},te={class:"w-full max-w-full px-3 lg:w-1/4 md:w-1/4"},ae={class:"mb-2"},le={class:"w-full max-w-full px-3 lg:w-2/4 md:w-2/4"},oe={class:"mb-2"},re={key:0,class:"flex flex-wrap items-end -mx-3"},ie={class:"w-full max-w-full px-3 lg:w-full md:w-full"},ne={key:0,class:"mb-2"},ce={class:"flex items-center justify-between pb-2 mb-2 space-x-12 text-sm border-b border-gray-200 md:space-x-24"},me=["textContent"],de={class:"flex"},_e=["onClick"],ue={key:1,class:"flex flex-wrap items-end -mx-3"},fe={class:"w-full max-w-full px-3 lg:w-full md:w-full"},pe={key:0,class:"mb-2"},ve={class:"flex items-center justify-between pb-2 mb-2 space-x-12 text-sm border-b border-gray-200 md:space-x-24"},he=["textContent"],ke={class:"flex"},xe=["onClick"],we={key:2,class:"flex flex-wrap items-end -mx-3"},ge={class:"w-full max-w-full px-3 lg:w-full md:w-full"},be={key:0,class:"mb-2"},ye={class:"flex items-center justify-between pb-2 mb-2 space-x-12 text-sm border-b border-gray-200 md:space-x-24"},Ce=["textContent"],Ve={class:"flex"},Ue=["onClick"],$e={class:"flex flex-wrap items-end -mx-3"},Me={class:"w-full max-w-full px-3 lg:w-full md:w-full"},Ne={class:"mb-2"},Fe={class:"w-full max-w-full px-3 lg:w-full md:w-full"},Re={class:"mb-4"},Se={class:"flex"},De={class:"flex flex-wrap items-end -mx-3"},Ie={class:"w-full max-w-full px-3 lg:w-full md:w-full"},Be={class:"mb-4"},Ye=t("div",{class:"row-span-2 col-span-2"},null,-1),Ze={__name:"ServiceForm",props:["form_id","case"],emits:["resetForm"],setup(N,{emit:F}){const c=N;q();const{base_url:x,refreshComponent:w}=O(),e=U(new Form({form_id:0,case_id:0,service_date:CMS.today,service_time:"",remarks:"",service_type:"N",technician_name:"",status:"",problems:[],maintenances:[],resolving_actions:[]})),o=U({create_url:"services",showProb:!0,showMain:!0,showResolve:!0,case:{case_no:"",status:"",open_date:"",work_types:"",work_order_types:"",case_id:0},machine:{name_code_no:"",serial_no:"",department_name:"",brand_name:"",area_name:"",machine_model:"",machine_type:""}}),R=A(()=>c.form_id>0?"Update  Servcie Details":"Add Service Details");T(()=>{c.case&&I(),c.form_id>0&&D()});const S=()=>{e.postForm(x.value+"/"+o.create_url).then(function(a){console.log(a),a.success&&(Utilities.showPopMessage("Your data has been saved successfully!"),a.service&&window.open(x.value+"/service-print/"+a.service.id,"_blank"),F("resetForm"))}).catch(function(a){})},D=()=>{axios.get(x.value+"/services/"+c.form_id+"/edit").then(function(a){if(a.data.success){let i=a.data.department;e.name=i.name}e.form_id=c.form_id}).catch(function(a){})},I=()=>{if(e.case_id=c.case.id,o.case_id=c.case.id,o.case.case_no=c.case.case_no,o.case.status=c.case.status,o.case.open_date=c.case.open_date,o.case.work_types=c.case.work_types,o.case.work_order_types=c.case.work_order_types,o.case.work_types=="Installation"?e.service_type="I":o.case.work_types=="Maintenance"?e.service_type="M":e.service_type="R",c.case.machine){let a=c.case.machine;o.machine.name_code_no=a.name_code_no,o.machine.serial_no=a.serial_no,a.department&&(o.machine.department_name=a.department.name),a.brand&&(o.machine.brand_name=a.brand.name),a.area&&(o.machine.area_name=a.area.name),a.machine_model&&(o.machine.machine_model=a.machine_model.model_no),a.machine_type&&(o.machine.machine_type=a.machine_type.name)}},B=()=>{window.history.back()},Y=(a,i,s)=>{e.problems.find(r=>r.problem_id==a)||e.problems.push({id:0,is_remarks:"N",remarks:"",name:s.name,problem_id:a}),w(o,"showProb")},P=(a,i,s)=>{e.maintenances.find(r=>r.maintenance_id==a)||e.maintenances.push({id:0,is_remarks:"N",remarks:"",name:s.name,maintenance_id:a}),w(o,"showMain")},j=(a,i,s)=>{e.resolving_actions.find(r=>r.resolving_action_id==a)||e.resolving_actions.push({id:0,is_remarks:"N",remarks:"",name:s.name,resolving_action_id:a}),w(o,"showResolve")},g=(a,i)=>{e[a].splice(i,1)};return(a,i)=>(n(),d("div",null,[l(E,{title:R.value},{default:u(()=>[t("div",Q,[t("div",W,[l(J,{case:o.case,machine:o.machine},null,8,["case","machine"])]),t("div",X,[t("fieldset",Z,[t("legend",{class:"text-base rounded font-semibold bg-teal-600 text-white px-3",textContent:h(e.service_type=="I"?"Installation":e.service_type=="M"?"Maintenance Details ":"Service Details")},null,8,ee),t("div",se,[t("div",te,[t("div",ae,[l(p,{for:"service_date",value:e.service_type=="I"?"Installation Date":"Service Date "},null,8,["value"]),l(L,{modelValue:e.service_date,"onUpdate:modelValue":i[0]||(i[0]=s=>e.service_date=s),"class-name":"service_date",error:!!e.errors.get("service_date")},null,8,["modelValue","error"]),l(v,{class:"mt-2",message:e.errors.get("service_date")},null,8,["message"])])]),t("div",le,[t("div",oe,[l(p,{for:"technician_name",value:"Technician Name"}),l(K,{modelValue:e.technician_name,"onUpdate:modelValue":i[1]||(i[1]=s=>e.technician_name=s),type:"text",required:"",error:!!e.errors.get("technician_name")},null,8,["modelValue","error"]),l(v,{class:"mt-2",message:e.errors.get("technician_name")},null,8,["message"])])])]),e.service_type=="R"?(n(),d("div",re,[t("div",ie,[o.showProb?(n(),d("div",ne,[l(p,{for:"problem_ids",value:"Issues"}),l(z,{onUpdateProblem:Y}),l(v,{class:"mt-2",message:e.errors.get("problem_ids")},null,8,["message"])])):_("",!0)])])):_("",!0),(n(!0),d(b,null,y(e.problems,(s,m)=>(n(),d("div",{class:"ml-4 md:ml-8 lg:ml-12",key:s.problem_id},[t("div",ce,[t("p",{class:"flex items-end text-sm text-indigo-500",textContent:h(m+1+") "+s.name)},null,8,me),t("div",de,[l(V,{checked:s.is_remarks,"onUpdate:checked":r=>s.is_remarks=r,"true-value":"Y","false-value":"N",id:"problem_is_remarks"+m},{default:u(()=>[f("more details")]),_:2},1032,["checked","onUpdate:checked","id"]),t("i",{class:"mr-1 fas fa-trash text-red-400 ml-4 mt-1","aria-hidden":"true",onClick:r=>g("problems",m)},null,8,_e)])]),s.is_remarks=="Y"?(n(),C(k,{key:0,modelValue:s.remarks,"onUpdate:modelValue":r=>s.remarks=r},null,8,["modelValue","onUpdate:modelValue"])):_("",!0)]))),128)),e.service_type=="M"?(n(),d("div",ue,[t("div",fe,[o.showMain?(n(),d("div",pe,[l(p,{for:"service_date",value:"Maintenance Steps"}),l(H,{onUpdateMaintenance:P}),l(v,{class:"mt-2",message:e.errors.get("maintenance_ids")},null,8,["message"])])):_("",!0)])])):_("",!0),(n(!0),d(b,null,y(e.maintenances,(s,m)=>(n(),d("div",{class:"ml-4 md:ml-8 lg:ml-12",key:s.maintenance_id},[t("div",ve,[t("p",{class:"flex items-end text-sm text-indigo-500",textContent:h(m+1+") "+s.name)},null,8,he),t("div",ke,[l(V,{checked:s.is_remarks,"onUpdate:checked":r=>s.is_remarks=r,"true-value":"Y","false-value":"N",id:"maintenance_is_remarks"+m},{default:u(()=>[f("more details")]),_:2},1032,["checked","onUpdate:checked","id"]),t("i",{class:"mr-1 fas fa-trash text-red-400 ml-4 mt-1","aria-hidden":"true",onClick:r=>g("maintenances",m)},null,8,xe)])]),s.is_remarks=="Y"?(n(),C(k,{key:0,modelValue:s.remarks,"onUpdate:modelValue":r=>s.remarks=r},null,8,["modelValue","onUpdate:modelValue"])):_("",!0)]))),128)),e.service_type=="R"?(n(),d("div",we,[t("div",ge,[o.showResolve?(n(),d("div",be,[l(p,{for:"service_date",value:"Resolving Actions"}),l(G,{onUpdateResolvingAction:j}),l(v,{class:"mt-2",message:e.errors.get("resolving_ids")},null,8,["message"])])):_("",!0)])])):_("",!0),(n(!0),d(b,null,y(e.resolving_actions,(s,m)=>(n(),d("div",{class:"ml-4 md:ml-8 lg:ml-12",key:s.resolving_action_id},[t("div",ye,[t("p",{class:"flex items-end text-sm text-indigo-500",textContent:h(m+1+") "+s.name)},null,8,Ce),t("div",Ve,[l(V,{checked:s.is_remarks,"onUpdate:checked":r=>s.is_remarks=r,"true-value":"Y","false-value":"N",id:"resolving_action_is_remarks"+m},{default:u(()=>[f("more details")]),_:2},1032,["checked","onUpdate:checked","id"]),t("i",{class:"mr-1 fas fa-trash text-red-400 ml-4 mt-1","aria-hidden":"true",onClick:r=>g("resolving_actions",m)},null,8,Ue)])]),s.is_remarks=="Y"?(n(),C(k,{key:0,modelValue:s.remarks,"onUpdate:modelValue":r=>s.remarks=r},null,8,["modelValue","onUpdate:modelValue"])):_("",!0)]))),128)),t("div",$e,[t("div",Me,[t("div",Ne,[l(p,{for:"remarks",value:"Remarks"}),l(k,{modelValue:e.remarks,"onUpdate:modelValue":i[2]||(i[2]=s=>e.remarks=s),type:"text",required:"",error:!!e.errors.get("remarks")},null,8,["modelValue","error"]),l(v,{class:"mt-2",message:e.errors.get("remarks")},null,8,["message"])])])]),t("div",Fe,[t("div",Re,[l(p,{for:"status",value:"Status"}),t("div",Se,[l(M,{class:"mr-4 ml-4",value:"C",checked:e.status,"onUpdate:checked":i[3]||(i[3]=s=>e.status=s),name:"status",id:"statusM"},{default:u(()=>[f("Completed & Closed")]),_:1},8,["checked"]),l(M,{class:"mr-4 ml-3",value:"F",checked:e.status,"onUpdate:checked":i[4]||(i[4]=s=>e.status=s),name:"status",id:"statusF"},{default:u(()=>[f("Required Follow-Up")]),_:1},8,["checked"])]),l(v,{class:"mt-2",message:e.errors.get("status")},null,8,["message"])])]),t("div",De,[t("div",Ie,[t("div",Be,[l($,{onButtonClicked:S,type:"save"},{default:u(()=>[f("Save")]),_:1}),l($,{onButtonClicked:i[5]||(i[5]=s=>B()),type:"cancel"},{default:u(()=>[f("Cancel")]),_:1})])])])])]),Ye])]),_:1},8,["title"])]))}};export{Ze as default};
