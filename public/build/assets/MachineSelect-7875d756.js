import{g as f}from"./globalMixin-827f0fbc.js";import{d as p,q as g,j as v,a8 as x,o as h,e as y,n as b}from"./app-92be7c25.js";const w=["multiple","disabled","value"],B={__name:"MachineSelect",props:{modelValue:[String,Number],index:{default:-1,type:[String,Number]},initials:{default:()=>[],type:Array},selected:{default:()=>[],type:Array},url:{default:"machines/filtered",type:String},getIndex:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean},customClass:{default:"selectItem",type:String},focus:{default:!1,type:Boolean},enableNew:{default:!1,type:Boolean},placeholder:{default:"Select Machine",type:String},type:{default:"all",type:String},multiple:{default:!1,type:Boolean},allowClear:{default:!0,type:Boolean},error:{default:!1}},emits:["updateMachine","update:modelValue"],setup(n,{emit:o}){const e=n,{base_url:r}=f(),d=p(0),u=g(()=>e.error?"machine_"+e.index+" border-red-400 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm mt-1 block w-full":"machine_"+e.index+" border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm mt-1 block w-full");v(()=>{s()}),x(()=>{$(".machine_"+e.index).select2("destroy")});const s=()=>{var t=$(".machine_"+e.index);t.select2({dropdownAutoWidth:!0,placeholder:e.placeholder,allowClear:e.allowClear,width:"100%",data:e.initials,dropdownParent:$("body"),ajax:{method:"POST",url:function(){return r.value+"/"+e.url},delay:250,dataType:"json",cache:!0,data:function(l){var a={search:l.term,page:l.page||1,type:e.type};return a},processResults:function(l,a){return a.page=a.page||1,l.results.forEach(function(i){i.text=i.serial_no}),l.pagination={more:a.page*30<l.count_filtered},l}},templateResult:m,templateSelection:c}).on("change",function(){console.log("select2 change ");var l=$(".machine_"+e.index).val();e.multiple==!1?o("update:modelValue",l):e.multiple==!0&&o("updateMachine",l,e.index)}).on("select2:select",function(l){console.log("select2 Select ");var a=$(".machine_"+e.index).val();d.value=l.params.data,d.value!={}&&o("updateMachine",a,e.index,d.value)}).on("select2:clear",function(l){var a=$(".machine_"+e.index).val();if(e.multiple==!1){var i=a||0;o("input",i)}}),typeof e.index<"u"&&$(".machine_"+e.index).val(e.selected).change()},c=t=>{if(!t.id)return t.text;var l=$('<div class="flex flex-wrap -mx-3"><div class="w-full md:w-1/1 px-3 md:mb-0">'+t.text+"</div></div>");return l},m=t=>{if(!t.id)return t.text;var l=$('<div class="flex flex-wrap -mx-3"><div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">'+t.text+'</div><div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">'+t.machine_model.model_no+'</div><div class="w-full md:w-1/3 px-3 mb-6 md:mb-0">'+t.department.name+"</div></div>");return l};return(t,l)=>(h(),y("select",{multiple:n.multiple,disabled:n.disabled,class:b(u.value),value:n.modelValue,key:e.index,onInput:l[0]||(l[0]=a=>t.$emit("update:modelValue",a.target.value))},null,42,w))}};export{B as default};
