import{g as s}from"./globalMixin-827f0fbc.js";import{d as c,q as f,j as p,a8 as m,o as g,e as y,n as b}from"./app-92be7c25.js";const x=["multiple","value","disabled"],v={__name:"RoleSelect",props:{modelValue:[String,Number],index:{default:-1,type:[String,Number]},initials:{default:()=>[],type:Array},selected:{default:()=>[],type:Array},url:{default:"roles/filtered",type:String},getIndex:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean},customClass:{default:"selectItem",type:String},focus:{default:!1,type:Boolean},enableNew:{default:!1,type:Boolean},placeholder:{default:"Select role",type:String},type:{default:"all",type:String},multiple:{default:!1,type:Boolean},allowClear:{default:!0,type:Boolean},projectId:{default:0,type:[Number,String]},error:{default:!1}},emits:["updateState","update:modelValue"],setup(a,{emit:o}){const e=a,{base_url:r}=s();c(0);const u=f(()=>e.error?"role_"+e.index+" border-red-400 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm mt-1 block w-full":"role_"+e.index+" border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm mt-1 block w-full");p(()=>{i()}),m(()=>{$(".role_"+e.index).select2("destroy")});const i=()=>{console.log("base_url"),console.log(r.value);var d=$(".role_"+e.index);d.select2({dropdownAutoWidth:!0,placeholder:e.placeholder,allowClear:e.allowClear,width:"100%",data:e.initials,dropdownParent:$("body"),ajax:{method:"POST",url:function(){return r.value+"/"+e.url},delay:250,dataType:"json",cache:!0,data:function(t){var l={search:t.term,page:t.page||1,type:e.type};return l},processResults:function(t,l){return l.page=l.page||1,t.results.forEach(function(n){n.text=n.name}),t.pagination={more:l.page*30<t.count_filtered},t}},templateResult:e.setName,templateSelection:e.selection}).on("change",function(){var t=$(".role_"+e.index).val();e.multiple==!1?o("update:modelValue",t):e.multiple==!0&&o("updateState",t,e.index)}).on("select2:select",function(t){var l=$(".role_"+e.index).val();e.selected_data=t.params.data,e.selected_data!={}&&o("updateState",l,e.index,e.selected_data)}).on("select2:clear",function(t){var l=$(".role_"+e.index).val();if(e.multiple==!1){var n=l||0;o("input",n)}}),typeof e.index<"u"&&$(".role_"+e.index).val(e.selected).change()};return(d,t)=>(g(),y("select",{multiple:a.multiple,ref:"input",class:b(u.value),value:a.modelValue,disabled:a.disabled},null,10,x))}};export{v as default};
